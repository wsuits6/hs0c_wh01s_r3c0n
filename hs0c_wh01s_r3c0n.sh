#!/usr/bin/env bash
set -euo pipefail

# === Colors ===
RED="\033[1;31m"
GREEN="\033[1;32m"
CYAN="\033[1;36m"
YELLOW="\033[1;33m"
RESET="\033[0m"

# === Banner ===
cat <<'HSOCIETY'
██████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████
███████████████                                            ███████████████
███████████████  ████████████████████████████████████████  ███████████████
███████████████  ███████████                  ███████████  ███████████████
███████████████  ███████     ████████████████     ███████  ███████████████
███████████████  █████   ████████████████████████   █████  ███████████████
███████████████  ███   ████████████████████████████   ███  ███████████████
████████████████ ██  ███         █████████        ███  ██  ███████████████
███████████████  ██      ███████   ████    ██████      ██  ███████████████
███████████████  █ ██ ████████████      ████████████ ██ █  ███████████████
███████████████  ████ █       ██████  ██████       █ ████  ███████████████
███████████████  ████  █        ████   ███       █ █ ████  ███████████████
███████████████  █    █   ██████          ██████   █    █  ███████████████
███████████████  █  █ █  ████████  █  █  ████████  █ █  █  ███████████████
███████████████  █ ██   █      █   █  █   █      █    █ █  ███████████████
███████████████  █    ██  ████   ██    ██   ████  ██    █  ███████████████
███████████████  █  ███  ████   █   ██   █   ████  ███  █  ███████████████
███████████████  █ ████        ████     ███        ████ █  ███████████████
███████████████  █  ███████████████████████████████████ █  ███████████████
███████████████  ██ ██████████████████████████████████ ██  ███████████████
███████████████  ███  ███████████████████████████████ ███  ███████████████
███████████████  ████     ████              █████    ████  ███████████████
███████████████  █████        ██████████████        █████  ███████████████
███████████████  █████  █████     ███████    █████  █████  ███████████████
███████████████  ██████  ███████          ███████  ██████  ███████████████
███████████████  ███████  █████████████████████   ███████  ███████████████
███████████████  ████████    █████████████████   ████████  ███████████████
███████████████  ██████████   ██████████████   ██████████  ███████████████
███████████████  ████████████                ████████████  ███████████████
███████████████  ████████████████████████████████████████  ███████████████
███████████████                                            ███████████████
███████████████  ██ ██ ██████████ █████ ██ ███████████ ██  ███████████████
███████████████  ██ ██ ██   ██  █ ██    ██ █     █   ███   ███████████████
███████████████  ██ ██   ██ ██  █ ██    ██ ████ ██   ███   ███████████████
███████████████  ██ ██ ██ ████  █ ██ ██ ██ █    ██    ██   ███████████████
███████████████  ██ ██  ███   ██   ███  ██ ████  █    █    ███████████████
███████████████                                            ███████████████
██████████████████████████████████████████████████████████████████████████
██████████████████████████████████████████████████████████████████████████
                               HSOCIETY
HSOCIETY

# === Input ===
if [[ $# -lt 1 ]]; then
  echo -e "${RED}[!] Usage: $0 <domain>${RESET}"
  exit 1
fi
DOMAIN=$1

echo -e "${CYAN}[+] Starting recon for:${RESET} $DOMAIN"

# === WHOIS Lookup ===
echo -e "\n${YELLOW}=== WHOIS Info ===${RESET}"
whois "$DOMAIN" | egrep -i "Registrar|Registrant|Email|Name Server|Creation Date|Expiry" || \
  echo -e "${RED}[!] WHOIS lookup failed${RESET}"

# === DNS Records ===
echo -e "\n${YELLOW}=== DNS Info ===${RESET}"
dig +short A "$DOMAIN" || echo -e "${RED}[!] No A record found${RESET}"
dig +short NS "$DOMAIN" || echo -e "${RED}[!] No NS record found${RESET}"
dig +short MX "$DOMAIN" || echo -e "${RED}[!] No MX record found${RESET}"

# === Subdomain Discovery (crt.sh) ===
echo -e "\n${YELLOW}=== Subdomains (crt.sh) ===${RESET}"
curl -s "https://crt.sh/?q=%25.$DOMAIN&output=json" | \
  jq -r '.[].name_value' 2>/dev/null | sort -u | sed "s/^/${GREEN}[sub] ${RESET}/" || \
  echo -e "${RED}[!] Could not fetch subdomains${RESET}"

# === Resolve Subdomains to IPs ===
echo -e "\n${YELLOW}=== Subdomain IPs ===${RESET}"
for sub in $(curl -s "https://crt.sh/?q=%25.$DOMAIN&output=json" | jq -r '.[].name_value' 2>/dev/null | sort -u); do
  ip=$(dig +short A $sub | head -n1)
  if [[ -n "$ip" ]]; then
    echo -e "${GREEN}$sub ${RESET}-> ${CYAN}$ip${RESET}"
  fi
done

# === WHOIS IP Lookup ===
echo -e "\n${YELLOW}=== WHOIS for IPs ===${RESET}"
for ip in $(dig +short A "$DOMAIN"); do
  echo -e "${CYAN}[*] WHOIS for $ip:${RESET}"
  whois "$ip" | egrep -i "OrgName|Country|NetRange|CIDR|Owner" || \
    echo -e "${RED}[!] WHOIS lookup failed for $ip${RESET}"
done

echo -e "\n${GREEN}[✓] Recon complete for $DOMAIN${RESET}"
